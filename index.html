<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Animal Run ‚Äî 3D</title>
  <style>
    :root{
      --sky1:#b3e5ff; --sky2:#6ec1ff; --grass:#78d13f; --ink:#0f172a; --panel:#ffffff;
      --barL:#22c55e; --barR:#ef4444; --ui:#111827; --rail:#cbd5e1; --accent:#f59e0b;
      --depth-persp: 1100px; --depth-back: -900px; --depth-ground: -220px; --z-fx: 600;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif; color:var(--ink);
      background:linear-gradient(var(--sky1),var(--sky2));}
    .wrap{max-width:1100px; margin:auto; padding:16px; display:flex; flex-direction:column; gap:14px}
    header{display:flex; align-items:center; justify-content:space-between; gap:10px}
    h1{margin:0; font-size:28px}
    .btn{cursor:pointer; border:2px solid #0002; background:#ffd166; border-radius:12px; padding:10px 14px; font-weight:700}
    .panel{background:var(--panel); border:3px solid #0002; border-radius:18px}

    .gallery{display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:12px; padding:12px}
    .card{border:3px solid #0002; border-radius:16px; padding:8px; cursor:pointer; background:#fff; transition:transform .08s}
    .card:hover{transform:translateY(-2px)}
    .thumb{width:100%; aspect-ratio:1/1; border-radius:12px; background:#eef; display:grid; place-items:center; overflow:hidden}
    .thumb img{width:100%; height:100%; object-fit:cover}
    .label{margin-top:6px; text-align:center; font-weight:700}

    .arena{display:none}
    .arena.show{display:block}
    .cam{position:relative; border:3px solid #0002; border-radius:18px; overflow:hidden; min-height:520px; perspective:var(--depth-persp); transform-style:preserve-3d;}
    .scene{position:relative; height:520px; transform-style:preserve-3d;}

    .backdrop{position:absolute; inset:-20% -20% 0 -20%; transform:translateZ(var(--depth-back));}
    .backdrop::before{content:""; position:absolute; inset:0; background:linear-gradient(#dff2ff 0%, #bfe6ff 100%);}

    .ground3d{position:absolute; left:50%; top:68%; width:2200px; height:2200px; transform:translate(-50%,-50%) rotateX(78deg) translateZ(var(--depth-ground)); background:linear-gradient(#7fd24b 0%, #6fc543 60%, #5aa93a 100%);}

    .fighter{position:absolute; bottom:100px; width:240px; height:240px; display:grid; place-items:center; filter:drop-shadow(0 12px 0 #0001); transform-style:preserve-3d;}
    .fighter img{width:100%; height:100%; object-fit:contain; border-radius:16px; background:#fff}
    .left{left:6%; transform:translateZ(120px);}
    .right{right:6%; transform:translateZ(120px);}

    .hud{position:absolute; top:12px; left:0; right:0; display:flex; justify-content:space-between; padding:0 12px; gap:12px; z-index:10}
    .hpbox{flex:1; display:flex; flex-direction:column; gap:6px}
    .name{font-weight:800; text-shadow:0 1px 0 #fff}
    .bar{height:16px; background:var(--rail); border:2px solid #0002; border-radius:999px; overflow:hidden}
    .hp{height:100%; width:100%}
    .hpL{background:linear-gradient(90deg,var(--barL),#c0f2c9)}
    .hpR{background:linear-gradient(90deg,var(--barR),#fecaca)}

    .vs{position:absolute; top:8px; left:50%; transform:translateX(-50%); background:#fff; border:3px solid #0002; padding:4px 10px; border-radius:999px; font-weight:900; z-index:11}
    .count{position:absolute; inset:0; display:grid; place-items:center; font-size:110px; font-weight:900; color:#0008; text-shadow:0 4px 0 #fff; z-index:12}

    .log{margin:10px; padding:10px; border:3px solid #0002; border-radius:14px; background:#fff; min-height:48px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>üèÉ‚Äç‚ôÇÔ∏è Animal Run 3D</h1>
      <div style="display:flex; gap:8px; align-items:center">
        <button class="btn" id="saveDefaults">Save as my defaults</button>
        <button class="btn" id="goHome" style="display:none">Back to Gallery</button>
      </div>
    </header>

    <section class="panel" id="galleryPanel">
      <div class="gallery" id="gallery"></div>
    </section>

    <section class="arena" id="arena">
      <div class="cam" id="camera">
        <div class="scene" id="scene">
          <div class="backdrop"></div>
          <div class="ground3d"></div>
          <div class="hud">
            <div class="hpbox">
              <div class="name" id="nameL">Player</div>
              <div class="bar"><div class="hp hpL" id="hpLeft"></div></div>
            </div>
            <div class="hpbox" style="text-align:right">
              <div class="name" id="nameR">Opponent</div>
              <div class="bar"><div class="hp hpR" id="hpRight"></div></div>
            </div>
          </div>
          <div class="vs">VS</div>
          <div class="fighter left" id="boxL"><img id="imgL" alt="left animal"/></div>
          <div class="fighter right" id="boxR"><img id="imgR" alt="right animal"/></div>
          <div class="count" id="countdown" style="display:none">3</div>
        </div>
      </div>
      <div class="log" id="log">Pick an animal to start‚Ä¶</div>
      <div style="display:flex; gap:8px; padding:8px 10px">
        <button class="btn" id="playAgain" style="display:none">Play again</button>
      </div>
    </section>
  </div>
  <script>
    const PRELOADED = [
      { name: 'Tiger', src: 'assets/animals/Tiger.jpeg' },
      { name: 'Elephant', src: 'assets/animals/Elephant.jpeg' },
      { name: 'Lion', src: 'assets/animals/Lion.jpeg' },
      { name: 'Cheetah', src: 'assets/animals/Cheetah.jpeg' },
      { name: 'Wolf', src: 'assets/animals/Wolf.jpeg' }
    ];
    const gallery=document.getElementById('gallery');
    const arena=document.getElementById('arena');
    const imgL=document.getElementById('imgL');
    const imgR=document.getElementById('imgR');
    const nameL=document.getElementById('nameL');
    const nameR=document.getElementById('nameR');
    const hpLeft=document.getElementById('hpLeft');
    const hpRight=document.getElementById('hpRight');
    const countdownEl=document.getElementById('countdown');
    const log=document.getElementById('log');

    let animals=PRELOADED.slice();
    const el=(t,a={},...c)=>{const n=document.createElement(t);Object.entries(a).forEach(([k,v])=>{if(k.startsWith('on'))n.addEventListener(k.slice(2),v);else n.setAttribute(k,v)});c.flat().forEach(x=>n.appendChild(typeof x==='string'?document.createTextNode(x):x));return n};
    function renderGallery(){gallery.innerHTML='';animals.forEach((a,i)=>{gallery.appendChild(el('button',{class:'card',onclick:()=>selectAnimal(i)},el('div',{class:'thumb'},el('img',{src:a.src,alt:a.name})),el('div',{class:'label'},a.name)));});}

    function selectAnimal(i){if(animals.length<2)return;const p=animals[i];let j=i;while(j===i)j=Math.floor(Math.random()*animals.length);const o=animals[j];document.getElementById('galleryPanel').style.display='none';arena.classList.add('show');document.getElementById('goHome').style.display='inline-block';imgL.src=p.src;imgR.src=o.src;nameL.textContent=p.name;nameR.textContent=o.name;hpLeft.style.width='100%';hpRight.style.width='100%';countdown(()=>startFight(p,o));}

    function countdown(done){countdownEl.style.display='grid';let n=3;countdownEl.textContent=n;const t=setInterval(()=>{n--;if(n>0)countdownEl.textContent=n;else{countdownEl.textContent='Go!';setTimeout(()=>{countdownEl.style.display='none';clearInterval(t);done();},550)}},650);}

    function startFight(p,o){let L=100,R=100;let turn=0;const tick=setInterval(()=>{const dmg=8+Math.floor(Math.random()*13);if(turn===0){R=Math.max(0,R-dmg);hpRight.style.width=R+'%';log.textContent=`${p.name} hits ${o.name} for ${dmg}!`;}else{L=Math.max(0,L-dmg);hpLeft.style.width=L+'%';log.textContent=`${o.name} hits ${p.name} for ${dmg}!`;}if(L===0||R===0){clearInterval(tick);const w=R===0&&L>0?p:(L===0&&R>0?o:(Math.random()<.5?p:o));log.textContent=`üèÜ ${w.name} wins!`;document.getElementById('playAgain').style.display='inline-block';}else turn=1-turn;},1100);}

    document.getElementById('playAgain').addEventListener('click',()=>{log.textContent='Pick an animal to start‚Ä¶';document.getElementById('playAgain').style.display='none';document.getElementById('galleryPanel').style.display='block';arena.classList.remove('show');document.getElementById('goHome').style.display='none';});
    document.getElementById('goHome').addEventListener('click',()=>document.getElementById('playAgain').click());
    renderGallery();
  </script>
</body>
</html>
